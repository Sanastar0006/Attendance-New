<!doctype html>
<html lang="ta">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Staff Attendance - Login & Add User</title>
  <style>
    body { font-family: Arial, sans-serif; background:#f5f5f5; margin:0; }
    header { background:#222; padding:12px; color:#fff; display:flex; justify-content:space-between; align-items:center; }
    header h2 { margin:0; }
    header button { background:#4CAF50; border:none; padding:8px 14px; color:white; border-radius:6px; cursor:pointer; }
    .container { width:90%; max-width:400px; background:white; margin:40px auto; padding:20px; border-radius:8px; box-shadow:0 0 10px #ccc; }
    input { width:100%; padding:10px; margin-top:8px; margin-bottom:16px; border:1px solid #ccc; border-radius:6px; }
    .btn { width:48%; padding:10px; border:none; color:#fff; border-radius:6px; cursor:pointer; }
    .save { background:#28a745; }
    .clear { background:#dc3545; }
    /* Modal */
    #addUserModal { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.6); }
    .modal-content { background:white; width:90%; max-width:400px; margin:60px auto; padding:20px; border-radius:8px; }
  </style>
</head>
<body>

<header>
  <h2>Staff Attendance</h2>
  <button onclick="openAddUser()">Add User</button>
</header>

<div class="container">
  <h3>Login</h3>
  <label>Username</label>
  <input list="userList" id="loginUser" />
  <datalist id="userList"></datalist>

  <label>Password</label>
  <input type="password" id="loginPass" />

  <button class="btn save" onclick="login()">Login</button>
</div>

<!-- Add User Modal -->
<div id="addUserModal">
  <div class="modal-content">
    <h3>Add New User</h3>

    <label>Staff Name :</label>
    <input id="staffName" type="text" />

    <label>Staff ID :</label>
    <input id="staffId" type="text" />

    <label>User Name :</label>
    <input id="newUser" type="text" />

    <label>Create Your Password :</label>
    <input id="newPass" type="password" />

    <label>Confirm Password :</label>
    <input id="confirmPass" type="password" />

    <div style="display:flex; justify-content:space-between;">
      <button class="btn save" onclick="saveUser()">Save</button>
      <button class="btn clear" onclick="clearForm()">Clear</button>
    </div>

    <br>
    <button style="width:100%; padding:10px; border:none; background:#555; color:white; border-radius:6px;" onclick="closeAddUser()">Close</button>
  </div>
</div>

<script>
  function openAddUser() { document.getElementById('addUserModal').style.display='block'; }
  function closeAddUser() { document.getElementById('addUserModal').style.display='none'; }

  function clearForm(){
    staffName.value = "";
    staffId.value = "";
    newUser.value = "";
    newPass.value = "";
    confirmPass.value = "";
  }

  function loadUsers(){
    let users = JSON.parse(localStorage.getItem('users') || '[]');
    let list = document.getElementById('userList');
    list.innerHTML = "";
    users.forEach(u => {
      let opt = document.createElement('option');
      opt.value = u.username;
      list.appendChild(opt);
    });
  }

  loadUsers();

  function saveUser(){
    if(newPass.value !== confirmPass.value){ alert("Password Mismatch!"); return; }

    let users = JSON.parse(localStorage.getItem('users') || '[]');

    users.push({
      staffName: staffName.value,
      staffId: staffId.value,
      username: newUser.value,
      password: newPass.value
    });

    localStorage.setItem('users', JSON.stringify(users));
    alert("User Added Successfully!");
    loadUsers();
    closeAddUser();
  }

  function login(){
    let u = loginUser.value;
    let p = loginPass.value;

    let users = JSON.parse(localStorage.getItem('users') || '[]');
    let found = users.find(x => x.username === u && x.password === p);

    if(found){
      alert("Login Success!");
    } else {
      alert("Invalid Username or Password");
    }
  }
</script>

</body>
</html>
