<!DOCTYPE html>
<html lang="ta">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Staff Attendance Portal</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background:#f1f1f1;
      margin:0;
      padding:0;
    }
    header {
      background:#333;
      color:#fff;
      padding:15px;
      display:flex;
      justify-content:space-between;
      align-items:center;
    }
    header h2 { margin:0; }
    #addUserBtn {
      background:#00a2ff;
      border:none;
      color:white;
      padding:8px 14px;
      border-radius:6px;
      cursor:pointer;
    }
    
    .box {
      background:white;
      width:350px;
      margin:40px auto;
      padding:25px;
      border-radius:8px;
      box-shadow:0 0 10px #0002;
    }
    input,select,button {
      width:100%;
      padding:10px;
      margin-top:10px;
      border-radius:6px;
      border:1px solid #ccc;
    }
    button {
      background:#28a745;
      color:white;
      cursor:pointer;
      border:none;
    }

    /* Modal */
    #userModal {
      position:fixed;
      top:0; left:0;
      width:100%; height:100%;
      background:#0008;
      display:none;
      justify-content:center;
      align-items:center;
    }
    #userModal .modalBox {
      background:white;
      padding:25px;
      width:350px;
      border-radius:8px;
    }
    #clearBtn, #saveBtn { width:48%; }
    .rowBtn { display:flex; justify-content:space-between; }

    #attSection { display:none; padding:20px; }
  </style>
</head>
<body>

<header>
  <h2>Attendance Portal</h2>
  <button id="addUserBtn">Add User</button>
</header>

<!-- LOGIN -->
<div id="loginSection" class="box">
  <h3>Login</h3>
  <label>Username</label>
  <select id="loginUser"></select>

  <label>Password</label>
  <input type="password" id="loginPass" />

  <button id="loginBtn">Login</button>
  <p id="loginMsg" style="color:red"></p>
</div>

<!-- ATTENDANCE PAGE -->
<div id="attSection">
  <h2>Welcome <span id="attName"></span></h2>
  <p>You are now inside the Attendance Portal</p>
</div>

<!-- ADD USER MODAL -->
<div id="userModal">
  <div class="modalBox">
    <h3>Add User</h3>

    <label>Staff Name</label>
    <input type="text" id="uName" />

    <label>Staff ID</label>
    <input type="text" id="uID" />

    <label>Username</label>
    <input type="text" id="uUser" />

    <label>Create Password</label>
    <input type="password" id="uPass" />

    <label>Confirm Password</label>
    <input type="password" id="uCPass" />

    <div class="rowBtn">
      <button id="saveBtn">Save</button>
      <button id="clearBtn" style="background:#dc3545">Clear</button>
    </div>

    <button id="closeBtn" style="margin-top:10px;background:#555">Close</button>
  </div>
</div>

<script>
// Load Users
let users = JSON.parse(localStorage.getItem("attUsers") || "[]");

function loadUsers() {
  const sel = document.getElementById("loginUser");
  sel.innerHTML = "";
  users.forEach(u => {
    let op = document.createElement("option");
    op.value = u.username;
    op.textContent = u.username;
    sel.appendChild(op);
  });
}
loadUsers();

// Open Add User
addUserBtn.onclick = () => userModal.style.display = "flex";
closeBtn.onclick = () => userModal.style.display = "none";

// Clear
clearBtn.onclick = () => {
  uName.value = "";
  uID.value = "";
  uUser.value = "";
  uPass.value = "";
  uCPass.value = "";
};

// Save User (Local Only)
saveBtn.onclick = () => {
  if (uPass.value !== uCPass.value) {
    alert("Passwords not match machi!");
    return;
  }

  const newU = {
    name: uName.value,
    id: uID.value,
    username: uUser.value,
    password: uPass.value
  };

  users.push(newU);
  localStorage.setItem("attUsers", JSON.stringify(users));

  alert("User Added Successfully!");
  loadUsers();
  userModal.style.display = "none";
};

// LOGIN
loginBtn.onclick = () => {
  const u = loginUser.value;
  const p = loginPass.value;

  const found = users.find(x => x.username === u && x.password === p);

  if (!found) {
    loginMsg.textContent = "Invalid Username or Password";
    return;
  }

  loginSection.style.display = "none";
  attSection.style.display = "block";
  attName.textContent = found.name;
};
</script>

</body>
</html>
